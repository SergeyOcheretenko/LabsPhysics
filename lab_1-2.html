<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lab 1-2</title>
    <style>
        * {
            margin: 0;
            box-sizing: border-box;
        }
        table {
            border-collapse: collapse;
            width: 100%;
        }

        table td, table th {
            border: 1px solid #ddd;
            padding: 8px;
        }

        table tr:nth-child(even) {background-color: #f2f2f2;}

        table th {
            padding-top: 12px;
            padding-bottom: 12px;
        }

        .table-1__table {
            text-align: center;
        }
        .table-2__table {
            word-wrap: normal;
        }
        .container {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-evenly;
        }
        .column {
            margin-top: 20px;
            width: 49%;
            max-width: 600px;
        }
        canvas {
            margin-top: 50px;
        }

        @media only screen and (max-width: 1200px) {
            .column {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="column">
            <div class="table-1__wrapper">
                <h4>Таблица(какая-то)</h4>
                <table class="table-1__table">
                    <thead>
                        <th>&nbsp;</th>
                        <th>a, м</th>
                        <th>T= t/10, с</th>
                        <th>⟨T⟩, с</th>
                        <th>a², м²</th>
                        <th>⟨T⟩² ⋅ a, с² ⋅ м</th>
                    </thead>
                    <tbody id="table-1__body"></tbody>
                </table>
            </div>
        </div>
        <div class="column">
            <div class="table-2__wrapper">
                <h4>Значения(какие-то)</h4>
                <table class="table-2__table">
                    <tbody id="table-2__body"></tbody>
                </table>
            </div>
            <div class="canvas__wrapper">
                <canvas id="chart-1" width="400" height="400"></canvas>
                <canvas id="chart-2" width="400" height="400"></canvas>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script>
    <script type="text/javascript">
    // Lab 1-2
        const PI = Math.PI;

        const random = (min, max) => Math.random() * (max - min) + min;

        const pushElem = (array, min, max) => {
        for (let i = 0; i < 3; i++) array.push(Number(random(min, max).toFixed(3)));
        return array;
        }

        // Массив а
        const arrayA = [...new Array(20)].map((elem, idx) => (75 - idx * 3) / 100);

        let arrayT = []; //Массив периодов
        const diap = [2.093, 2.1, 2.068, 2.073, 2.052, 2.057, 2.037, 2.042, 2.021, 2.026, 2.002, 2.008, 1.991, 1.997, 1.982, 1.987, 1.972, 1.978, 1.968, 1.972, 1.964, 1.969, 1.962, 1.967, 1.971, 1.976, 1.981, 1.985, 1.998, 2.005, 2.033, 2.039, 2.078, 2.084, 2.134, 2.141, 2.228, 2.236, 2.335, 2.339]; //Диапазоны генерирования
        for(let i = 0; i < 40; i += 2) pushElem(arrayT, diap[i], diap[i+1]);

        const arrayAverage = [...new Array(20)].map((elem, idx) => Number(((arrayT[idx * 3 + 2] + arrayT[idx * 3 + 1] + arrayT[idx * 3]) / 3).toFixed(5))); //Массив средних значений периода

        const arraySquare = [...new Array(20)].map((elem, idx) => Number((arrayA[idx] ** 2).toFixed(4))); //Массив а*а

        const arraySquareT = [...new Array(20)].map((elem, idx) => Number((arrayA[idx] * arrayAverage[idx] ** 2).toFixed(4))); //Массив T*T*a

        const Tmin = Math.min(...arrayAverage);
        const a0 = arrayA[arrayAverage.indexOf(Tmin)];
        const k = Number(((arraySquareT[2] - arraySquareT[5])/(arraySquare[2] - arraySquare[5])).toFixed(3));
        const b = Number((arraySquareT[2] - k * arraySquare[2]).toFixed(3));
        const g = Number((4 * PI * PI / k).toFixed(2));
        const L = Math.sqrt(b * 3 * g / PI / PI).toFixed(3);
        const relativeError = (Math.abs(g - 9.8) / 9.8 * 100).toFixed(2);

        //Вывод:

        //Создание таблицы 1
        let tbody = document.getElementById('table-1__body')
        for (let i=0; i < arrayA.length; i++){
            tbody.insertAdjacentHTML("beforeend", `
                <tr>
                    <td rowspan="3">${i + 1}</td>
                    <td rowspan="3">${arrayA[i]}</td>
                    <td>${arrayT[3*i + 0]}</td>
                    <td rowspan="3">${arrayAverage[i]}</td>
                    <td rowspan="3">${arraySquare[i]}</td>
                    <td rowspan="3">${arraySquareT[i]}</td>
                </tr>
                <tr>
                    <td>${arrayT[3*i + 1]}</td>
                </tr>
                <tr>
                    <td>${arrayT[3*i + 2]}</td>
                </tr>
            `)
        };
        
        document.getElementById('table-2__body').innerHTML = `
            <tr>
                <td>T<sub>min</sub> (c) = ${Tmin}</td>
                <td>k (с² / м) = ${k}</td>
            </tr>
            <tr>
                <td>a<sub>0</sub> (м) = ${a0}; a<sub>0 теор</sub> (м) = 0.435</td>
                <td>b (м ⋅ с²) = ${b}</td>
            </tr>
            <tr>
                <td>g<sub>екс</sub>   (м / с²) = ${g}; g<sub>табл</sub> (м / с²) = 9.8</td>
                <td>L<sub>екс</sub> (м) = ${L}; L<sub>вим</sub> (м) = 1.5</td>
            </tr>
            <tr>
                <td colspan="2">Похибка ε = (|g<sub>екс</sub> – g<sub>табл</sub>| / g<sub>табл</sub>) ⋅ 100% = ${relativeError} %</td>
            </tr>
        `;

        // Перетворює два масиви в масив об'єктів координат
        function zip(array1, array2) {
            let result = [];
            let end = Math.min(array1.length, array2.length);
            for (let i=0; i < end; i++)
                result.push({x: array1[i], y: array2[i]});
            return result
        }

        // Розвертаємо масиви для побудови графіків
        for (array of [arrayA, arrayAverage, arraySquare, arraySquareT])
            array.reverse();

        // Графік 1
        new Chart(document.getElementById('chart-1').getContext('2d'), {
            type: 'line',
            data: {
                labels: arrayA,
                datasets: [{
                    // Виділяємо мінімальний показник
                    borderColor: '#FF6384',
                    backgroundColor: '#FF6384',
                    fill: false,
                    data: [{x: a0, y: Tmin}]
                },
                {
                    // Дані, де x = a, y = T
                    borderColor: '#36A2EB',
                    backgroundColor: '#36A2EB',
                    fill: false,
                    data: arrayAverage
                }]
            },
            options: {
                responsive: true,
                tooltips: {
                    mode: 'nearest',
                    intersect: false,
                },
                legend: {display: false},
                scales: {
                    xAxes: [{
                        scaleLabel: {
                            display: true,
                            labelString: 'a'
                        }
                    }],
                    yAxes: [{
                        scaleLabel: {
                            display: true,
                            labelString: '⟨T⟩'
                        }
                    }]
                }
            }
        });

        // Останній елемент списку з ⟨T⟩² ⋅ a
        let lastArraySquare = arraySquare[arraySquare.length - 1]

        // Графік 2
        new Chart(document.getElementById('chart-2').getContext('2d'), {
            type: 'scatter',
            data: {
                datasets: [{
                    // Дані, де x = a², y = ⟨T⟩² ⋅ a
                    borderColor: '#36A2EB',
                    backgroundColor: '#36A2EB',
                    data: zip(arraySquare, arraySquareT)
                },
                {
                    // Лінія побудована за y = k * x + b
                    borderColor: '#FF6384',
                    borderWidth: 1,
                    pointRadius: 0,
                    data: [{x: 0, y: b}, {x: lastArraySquare, y: k * lastArraySquare + b}],
                    fill: false,
                    type: 'line'
                }]
            },
            options: {
                responsive: true,
                tooltips: {
                    mode: 'nearest',
                    intersect: false,
                },
                legend: {display: false},
                scales: {
                    xAxes: [{
                        beginAtZero: true,
                        position: 'bottom',
                        scaleLabel: {
                            display: true,
                            labelString: 'a²'
                        }
                    }],
                    yAxes: [{
                        beginAtZero: true,
                        scaleLabel: {
                            display: true,
                            labelString: '⟨T⟩² ⋅ a'
                        }
                    }]
                }
            }
        });
    </script>
</body>
</html>